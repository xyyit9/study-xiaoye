{"version":3,"file":"vue.js","sources":["../../src/observer/proxy.js","../../src/observer/reactive.js","../../src/observer/observeArr.js","../../src/config.js","../../src/observer/array.js","../../src/observer/observer.js","../../src/observer/observe.js","../../src/state.js","../../src/compiler/astParser.js","../../src/compiler/generate.js","../../src/compiler/index.js","../../src/vdom/patch.js","../../src/lifecycle.js","../../src/init.js","../../src/vdom/vnode.js","../../src/vdom/index.js","../../src/index.js"],"sourcesContent":["function proxyData(vm, target, key) {\r\n  Object.defineProperty(vm, key, {\r\n    get() {\r\n      return vm[target][key];\r\n    },\r\n    set(newValue) {\r\n      vm[target][key] = newValue;\r\n    },\r\n  });\r\n}\r\n\r\nexport default proxyData;\r\n","import observe from \"./observe\";\r\n\r\nfunction defineReactiveData(data, key, value) {\r\n  // value可能也是一个对象\r\n  observe(value)\r\n  Object.defineProperty(data, key, {\r\n    get() {\r\n      console.log(\"响应式数据：获取\", value);\r\n      return value;\r\n    },\r\n    set(newValue) {\r\n      console.log(\"响应式数据：设置\", value);\r\n      if(newValue==value) return;\r\n      // newValue可能也是一个对象\r\n      observe(newValue)\r\n      value = newValue;\r\n    },\r\n  });\r\n}\r\nexport default defineReactiveData;\r\n","import observe from './observe'\r\nfunction observeArr(arr){\r\n    for(var i=0;i<arr.length;i++){\r\n        observe(arr[i])\r\n    }\r\n}\r\nexport default observeArr","//所有会改变原数组内容的原生方法\r\nvar ARR_METHODS = [\r\n  \"push\",\r\n  \"pop\",\r\n  \"shift\",\r\n  \"unshift\",\r\n  \"splice\",\r\n  \"sort\",\r\n  \"reverse\",\r\n];\r\n\r\nexport { ARR_METHODS };\r\n","/* 重写Array原型链上所有可能改变原数组的方法\r\n*  push新增的对象可能是对象或者数组，所以也需要进行观察，\r\n*  原数组数据的更改，可能引起页面视图改变，所以也要观察\r\n*/\r\nimport { ARR_METHODS } from \"../config\";\r\nimport observeArr from \"./observeArr\";\r\n//originArrMethods获取到原型\r\nvar originArrMethods = Array.prototype;\r\n// 创建新的对象实例，arrMthods的原型为originArrMethods\r\nvar arrMethods = Object.create(originArrMethods);\r\n\r\nARR_METHODS.map(function (m) {\r\n  arrMethods[m] = function () {\r\n    // arguments是类数组，Array.prototype.slice.call生成一个数组\r\n    var args = Array.prototype.slice.call(arguments);\r\n    // 原来数组的功能仍然需要保证\r\n    // this指向调用数组方法本身的对象，例如[1,2,3].splice(0,1,3),this就指向[1,2,3]\r\n    var rt = originArrMethods[m].apply(this, args);\r\n    var newArr;\r\n    switch (m) {\r\n      case \"push\":\r\n      case \"unshift\":\r\n        newArr = args;\r\n        break;\r\n      case \"splice\":\r\n        newArr = args.slice(2);\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    // newArr是一个数组，所以可以直接observeArr进行递归，而不需要进入到observe流程\r\n    newArr && observeArr(newArr);\r\n    return rt;\r\n  };\r\n});\r\nexport { arrMethods };\r\n","import defineReactiveData from './reactive'\r\nimport observeArr from './observeArr'\r\nimport {arrMethods} from './array'\r\nfunction Observer(data){\r\n    if(Array.isArray(data)){\r\n        // 覆盖原本的__proto__\r\n        data.__proto__=arrMethods\r\n        // data是数组，数组内部可能出现对象或者数组，所以需要对数组内部每一项进行观察\r\n        observeArr(data)\r\n    }else{\r\n        this.walk(data);\r\n    }\r\n}\r\nObserver.prototype.walk=function(data){\r\n    var keys=Object.keys(data);\r\n    for(var i=0;i<keys.length;i++){\r\n        var key=keys[i];\r\n        var value=data[key];\r\n        defineReactiveData(data,key,value);\r\n    }\r\n}\r\n\r\nexport default Observer;","import Observer from \"./observer\"\r\nfunction observe(data){\r\n    if(typeof data!=='object' || data===null) return;\r\n    new Observer(data)\r\n}\r\nexport default observe","import proxyData from './observer/proxy'\r\nimport observe from './observer/observe'\r\nfunction initState(vm) {\r\n  var options = vm.$options;\r\n  if (options.data) {\r\n    initData(vm);\r\n  }\r\n}\r\n\r\nfunction initData(vm) {\r\n  // 不污染用户原本的data\r\n  var data = vm.$options.data;\r\n  // data原本是一个方法，执行后可以通过vm._data.xxx这样获取\r\n  data = typeof data === \"function\" ? data.call(vm) : data || {};\r\n  vm._data = data;\r\n  for(var key in data){\r\n      // 将对象访问从vm._data.xxx变成vm.xxx的形式\r\n      proxyData(vm, '_data', key);\r\n  }\r\n  // 观察者模式_data\r\n  observe(vm._data);\r\n}\r\n\r\nexport { initState };\r\n","/**\r\n * 生成AST树\r\n */\r\n\r\n// id=\"app\" id='app' id=app\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/\r\n// 标签名 <my-header></my-header>\r\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`\r\n// <my:header></my:header>\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`\r\n// <div\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`)\r\n// > />\r\nconst startTagClose = /^\\s*(\\/?)>/\r\n// </div>\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`)\r\n\r\nfunction parseHtmlToAst(html) {\r\n  console.log(html)\r\n  let text,\r\n    root,\r\n    currentParent,\r\n    stack = []\r\n  while (html) {\r\n    let textEnd = html.indexOf('<')\r\n    // <尖括号在等于0的位置\r\n    if (textEnd === 0) {\r\n      const startTagMatch = parseStartTag()\r\n      // 进行type和属性解析 <div id=\"app\" style=\"color: red; font-size: 20px\">\r\n      if (startTagMatch) {\r\n        start(startTagMatch.tagName, startTagMatch.attrs)\r\n        continue\r\n      }\r\n      // 进行结束标签解析 </div>\r\n      const endTagMatch = html.match(endTag)\r\n      if (endTagMatch) {\r\n        advance(endTagMatch[0].length)\r\n        end(endTagMatch[1])\r\n        continue\r\n      }\r\n    }\r\n    // <尖括号在大于0的位置，说明是文本\r\n    if (textEnd > 0) {\r\n      text = html.substring(0, textEnd)\r\n      if (text) {\r\n        advance(text.length)\r\n        chars(text)\r\n      }\r\n    }\r\n  }\r\n\r\n  function parseStartTag() {\r\n    // 匹配<div\r\n    const start = html.match(startTagOpen)\r\n    let end, attr\r\n    if (start) {\r\n      const match = {\r\n        tagName: start[1], //div\r\n        attrs: [],\r\n      }\r\n      // 匹配上的<div就被删除\r\n      advance(start[0].length)\r\n      // 解析属性\r\n      while (\r\n        !(end = html.match(startTagClose)) &&\r\n        (attr = html.match(attribute))\r\n      ) {\r\n        match.attrs.push({\r\n          name: attr[1],\r\n          /**\r\n           * id=\"app\"  attr[3]为app\r\n           * id='app'  attr[4]为app\r\n           * id=app    attr[5]为app\r\n           *  */\r\n          value: attr[3] || attr[4] || attrs[5],\r\n        })\r\n        advance(attr[0].length)\r\n      }\r\n      // 解析尾括号，<div>的>\r\n      if (end) {\r\n        advance(end[0].length)\r\n        return match\r\n      }\r\n    }\r\n  }\r\n  function advance(n) {\r\n    html = html.substring(n)\r\n  }\r\n\r\n  function start(tagName, attrs) {\r\n    // console.log('---------开始----------')\r\n    // console.log(tagName, attrs)\r\n    const element = createASTElement(tagName, attrs)\r\n    if (!root) {\r\n      root = element\r\n    }\r\n    // text节点中可以使用\r\n    currentParent = element\r\n    stack.push(element)\r\n  }\r\n\r\n  function end(tagName) {\r\n    // console.log('---------结束----------')\r\n    // console.log(tagName)\r\n    const element = stack.pop()\r\n    currentParent = stack[stack.length - 1]\r\n    if (currentParent) {\r\n      element.parent = currentParent\r\n      currentParent.children.push(element)\r\n    }\r\n  }\r\n\r\n  function chars(text) {\r\n    // console.log('---------文本----------')\r\n    // console.log(text)\r\n    text = text.trim()\r\n    if (text.length > 0) {\r\n      currentParent.children.push({ type: 3, text })\r\n    }\r\n  }\r\n\r\n  function createASTElement(tagName, attrs) {\r\n    return {\r\n      tag: tagName,\r\n      type: 1,\r\n      children: [],\r\n      attrs,\r\n      parent,\r\n    }\r\n  }\r\n  console.log(root)\r\n  return root\r\n}\r\n\r\nexport { parseHtmlToAst }\r\n","/**\r\n * AST树转换成render函数\r\n */\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\r\nfunction generate(el) {\r\n  let children = geChildren(el)\r\n  let code = `_c('${el.tag}', ${\r\n    el.attrs.length > 0 ? `${formatProps(el.attrs)}` : 'undefined'\r\n  }${children ? `,${children}` : ''})`\r\n  return code\r\n}\r\n\r\nfunction geChildren(el) {\r\n  const children = el.children\r\n  if (children) {\r\n    return children.map((c) => generateChild(c)).join(',')\r\n  }\r\n}\r\n\r\nfunction generateChild(node) {\r\n  if (node.type === 1) {\r\n    return generate(node)\r\n  } else if (node.type === 3) {\r\n    let text = node.text\r\n    if (!defaultTagRE.test(text)) {\r\n      return `_v(${JSON.stringify(text)})`\r\n    }\r\n\r\n    let match,\r\n      index,\r\n      lastIndex = (defaultTagRE.lastIndex = 0),\r\n      textArr = []\r\n\r\n    // 你好 {{name}} 欢迎\r\n    while ((match = defaultTagRE.exec(text))) {\r\n      index = match.index //3\r\n      if (index > lastIndex) {\r\n        // 你好\r\n        textArr.push(JSON.stringify(text.slice(lastIndex, index)))\r\n      }\r\n      // {{name}}\r\n      textArr.push(`_s(${match[1].trim()})`)\r\n      lastIndex = index + match[0].length //11\r\n    }\r\n\r\n    if (lastIndex < text.length) {\r\n      // 欢迎\r\n      textArr.push(JSON.stringify(text.slice(lastIndex)))\r\n    }\r\n    return `_v(${textArr.join('+')})`\r\n  }\r\n}\r\n\r\nfunction formatProps(attrs) {\r\n  let attrStr = ''\r\n  for (var i = 0; i < attrs.length; i++) {\r\n    let attr = attrs[i]\r\n    if (attr.name === 'style') {\r\n      let styleAttrs = {}\r\n      // attr.value的值为string \"color: red; font-size: 20px\"\r\n      attr.value.split(';').map((styleAttr) => {\r\n        let [key, value] = styleAttr.split(':')\r\n        styleAttrs[key] = value\r\n      })\r\n      // JSON.stringify(styleAttrs)的值为{\"color\":\" red\",\" font-size\":\" 20px\"}\r\n      // 与attr.value的差异在于，每个key，value值都加上了引号，且有大括号\r\n      attr.value = styleAttrs\r\n    }\r\n    attrStr += `${attr.name}:${JSON.stringify(attr.value)},`\r\n  }\r\n\r\n  return `{${attrStr.slice(0, -1)}}`\r\n}\r\n\r\nexport { generate }\r\n","import { parseHtmlToAst } from './astParser'\r\nimport { generate } from './generate'\r\nfunction compileToRenderFunction(html) {\r\n  const ast = parseHtmlToAst(html)\r\n  const code =generate(ast)\r\n  const render = new Function(`with(this){ return ${code}}`)\r\n  return render\r\n}\r\n\r\nexport { compileToRenderFunction }\r\n","function patch(oldNode, vNode) {\r\n  let el = createElement(vNode),\r\n    parentElement = oldNode.parentNode\r\n  parentElement.insertBefore(el, oldNode.newSibling)\r\n  parentElement.removeChild(oldNode)\r\n}\r\n\r\nfunction createElement(vnode) {\r\n  const { tag, props, children, text } = vnode\r\n  if (typeof tag === 'string') {\r\n    vnode.el = document.createElement(tag)\r\n    updateProps(vnode)\r\n    children.map((child) => {\r\n      vnode.el.appendChild(createElement(child))\r\n    })\r\n  } else {\r\n    vnode.el = document.createTextNode(text)\r\n  }\r\n  return vnode.el\r\n}\r\n\r\nfunction updateProps(vnode) {\r\n  const el = vnode.el,\r\n    newProps = vnode.props || {}\r\n\r\n  for (let key in newProps) {\r\n    if (key === 'style') {\r\n      for (let sKey in newProps.style) {\r\n        el.style[sKey] = newProps.style[sKey]\r\n      }\r\n    } else if (key === 'class') {\r\n      el.className = el.class\r\n    } else {\r\n      el.setAttribute(key, newProps[key])\r\n    }\r\n  }\r\n}\r\n\r\nexport { patch }\r\n","import {patch} from './vdom/patch'\r\n\r\nfunction mountComponent(vm) {\r\n    vm._update(vm._render())\r\n}\r\n\r\nfunction lifecycleMixin(Vue) {\r\n    Vue.prototype._update = function(vnode){\r\n        const  vm = this;\r\n        patch(vm.$el, vnode)\r\n    }\r\n}\r\nexport { lifecycleMixin, mountComponent }\r\n","import { initState } from './state'\r\nimport { compileToRenderFunction } from './compiler'\r\nimport {mountComponent} from './lifecycle'\r\n\r\nfunction initMixin(Vue) {\r\n  Vue.prototype._init = function (options) {\r\n    var vm = this\r\n    //在vue实例上挂载options用户写的对象\r\n    vm.$options = options\r\n    initState(vm)\r\n\r\n    if (vm.$options.el) {\r\n      // 执行挂载函数\r\n      vm.$mount(vm.$options.el)\r\n    }\r\n  }\r\n\r\n  Vue.prototype.$mount = function (el) {\r\n    const vm = this,\r\n      options = vm.$options\r\n    el = document.querySelector(el)\r\n    vm.$el = el\r\n    // render > template > html式\r\n    if (!options.render) {\r\n      let template = options.template\r\n\r\n      if (!template && el) {\r\n        // outerHTML是包含自己的node节点\r\n        template = el.outerHTML\r\n      }\r\n      \r\n      const render = compileToRenderFunction(template)\r\n      options.render = render\r\n    }\r\n    mountComponent(vm)\r\n  }\r\n}\r\n\r\nexport { initMixin }\r\n","function createElement(tag, attrs = {}, ...children) {\r\n  return vnode(tag, attrs, children)\r\n}\r\n\r\nfunction createTextVnode(text) {\r\n  return vnode(undefined, undefined, undefined, text)\r\n}\r\n\r\nfunction vnode(tag, props, children, text) {\r\n  return {\r\n    tag,\r\n    props,\r\n    children,\r\n    text,\r\n  }\r\n}\r\nexport { createElement, createTextVnode }\r\n","// render函数 => 虚拟节点\r\n\r\nimport { createElement, createTextVnode } from './vnode'\r\nfunction renderMixin(Vue) {\r\n  Vue.prototype._c = function () {\r\n    return createElement(...arguments)\r\n  }\r\n  Vue.prototype._s = function (value) {\r\n    if (value == undefined) return\r\n    return typeof value === 'object' ? JSON.stringify(value) : value\r\n  }\r\n  Vue.prototype._v = function (text) {\r\n    return createTextVnode(text)\r\n  }\r\n  Vue.prototype._render = function () {\r\n    const vm = this,\r\n      render = vm.$options.render;\r\n\r\n    const  vnode = render.call(vm)\r\n    console.log('vnode', vnode)\r\n    return vnode\r\n  }\r\n}\r\n\r\nexport { renderMixin }\r\n","import {initMixin} from './init'\r\nimport {lifecycleMixin} from './lifecycle'\r\nimport {renderMixin} from './vdom'\r\n/*\r\n *数据劫持的目的，是为了在操作数据的过程中，不只是单纯的数据更改操作,\r\n *还要添加上页面渲染等操作\r\n */\r\nfunction Vue(options) {\r\n  this._init(options);\r\n}\r\n\r\ninitMixin(Vue)\r\nlifecycleMixin(Vue)\r\nrenderMixin(Vue)\r\n\r\nexport default Vue;\r\n"],"names":["proxyData","vm","target","key","Object","defineProperty","get","set","newValue","defineReactiveData","data","value","observe","console","log","observeArr","arr","i","length","ARR_METHODS","originArrMethods","Array","prototype","arrMethods","create","map","m","args","slice","call","arguments","rt","apply","newArr","Observer","isArray","__proto__","walk","keys","initState","options","$options","initData","_data","attribute","ncname","qnameCapture","startTagOpen","RegExp","startTagClose","endTag","parseHtmlToAst","html","text","root","currentParent","stack","textEnd","indexOf","startTagMatch","parseStartTag","start","tagName","attrs","endTagMatch","match","advance","end","substring","chars","attr","push","name","n","element","createASTElement","pop","parent","children","trim","type","tag","defaultTagRE","generate","el","geChildren","code","formatProps","c","generateChild","join","node","test","JSON","stringify","index","lastIndex","textArr","exec","attrStr","styleAttrs","split","styleAttr","compileToRenderFunction","ast","render","Function","patch","oldNode","vNode","createElement","parentElement","parentNode","insertBefore","newSibling","removeChild","vnode","props","document","updateProps","child","appendChild","createTextNode","newProps","sKey","style","className","setAttribute","mountComponent","_update","_render","lifecycleMixin","Vue","$el","initMixin","_init","$mount","querySelector","template","outerHTML","createTextVnode","undefined","renderMixin","_c","_s","_v"],"mappings":"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"}