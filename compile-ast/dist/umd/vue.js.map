{"version":3,"file":"vue.js","sources":["../../src/proxy.js","../../src/reactive.js","../../src/observeArr.js","../../src/config.js","../../src/array.js","../../src/observer.js","../../src/observe.js","../../src/state.js","../../src/compiler/index.js","../../src/init.js","../../src/index.js"],"sourcesContent":["function proxyData(vm, target, key) {\r\n  Object.defineProperty(vm, key, {\r\n    get() {\r\n      return vm[target][key];\r\n    },\r\n    set(newValue) {\r\n      vm[target][key] = newValue;\r\n    },\r\n  });\r\n}\r\n\r\nexport default proxyData;\r\n","import observe from \"./observe\";\r\n\r\nfunction defineReactiveData(data, key, value) {\r\n  // value可能也是一个对象\r\n  observe(value)\r\n  Object.defineProperty(data, key, {\r\n    get() {\r\n      console.log(\"响应式数据：获取\", value);\r\n      return value;\r\n    },\r\n    set(newValue) {\r\n      console.log(\"响应式数据：设置\", value);\r\n      if(newValue==value) return;\r\n      // newValue可能也是一个对象\r\n      observe(newValue)\r\n      value = newValue;\r\n    },\r\n  });\r\n}\r\nexport default defineReactiveData;\r\n","import observe from './observe'\r\nfunction observeArr(arr){\r\n    for(var i=0;i<arr.length;i++){\r\n        observe(arr[i])\r\n    }\r\n}\r\nexport default observeArr","//所有会改变原数组内容的原生方法\r\nvar ARR_METHODS = [\r\n  \"push\",\r\n  \"pop\",\r\n  \"shift\",\r\n  \"unshift\",\r\n  \"splice\",\r\n  \"sort\",\r\n  \"reverse\",\r\n];\r\n\r\nexport { ARR_METHODS };\r\n","/* 重写Array原型链上所有可能改变原数组的方法\r\n*  push新增的对象可能是对象或者数组，所以也需要进行观察，\r\n*  原数组数据的更改，可能引起页面视图改变，所以也要观察\r\n*/\r\nimport { ARR_METHODS } from \"./config\";\r\nimport observeArr from \"./observeArr\";\r\n//originArrMethods获取到原型\r\nvar originArrMethods = Array.prototype;\r\n// 创建新的对象实例，arrMthods的原型为originArrMethods\r\nvar arrMethods = Object.create(originArrMethods);\r\n\r\nARR_METHODS.map(function (m) {\r\n  arrMethods[m] = function () {\r\n    // arguments是类数组，Array.prototype.slice.call生成一个数组\r\n    var args = Array.prototype.slice.call(arguments);\r\n    // 原来数组的功能仍然需要保证\r\n    // this指向调用数组方法本身的对象，例如[1,2,3].splice(0,1,3),this就指向[1,2,3]\r\n    var rt = originArrMethods[m].apply(this, args);\r\n    var newArr;\r\n    switch (m) {\r\n      case \"push\":\r\n      case \"unshift\":\r\n        newArr = args;\r\n        break;\r\n      case \"splice\":\r\n        newArr = args.slice(2);\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    // newArr是一个数组，所以可以直接observeArr进行递归，而不需要进入到observe流程\r\n    newArr && observeArr(newArr);\r\n    return rt;\r\n  };\r\n});\r\nexport { arrMethods };\r\n","import defineReactiveData from './reactive'\r\nimport observeArr from './observeArr'\r\nimport {arrMethods} from './array'\r\nfunction Observer(data){\r\n    if(Array.isArray(data)){\r\n        // 覆盖原本的__proto__\r\n        data.__proto__=arrMethods\r\n        // data是数组，数组内部可能出现对象或者数组，所以需要对数组内部每一项进行观察\r\n        observeArr(data)\r\n    }else{\r\n        this.walk(data);\r\n    }\r\n}\r\nObserver.prototype.walk=function(data){\r\n    var keys=Object.keys(data);\r\n    for(var i=0;i<keys.length;i++){\r\n        var key=keys[i];\r\n        var value=data[key];\r\n        defineReactiveData(data,key,value);\r\n    }\r\n}\r\n\r\nexport default Observer;","import Observer from \"./observer\"\r\nfunction observe(data){\r\n    if(typeof data!=='object' || data===null) return;\r\n    new Observer(data)\r\n}\r\nexport default observe","import proxyData from './proxy'\r\nimport observe from './observe'\r\nfunction initState(vm) {\r\n  var options = vm.$options;\r\n  if (options.data) {\r\n    initData(vm);\r\n  }\r\n}\r\n\r\nfunction initData(vm) {\r\n  // 不污染用户原本的data\r\n  var data = vm.$options.data;\r\n  // data原本是一个方法，执行后可以通过vm._data.xxx这样获取\r\n  data = typeof data === \"function\" ? data.call(vm) : data || {};\r\n  vm._data = data;\r\n  for(var key in data){\r\n      // 将对象访问从vm._data.xxx变成vm.xxx的形式\r\n      proxyData(vm, '_data', key);\r\n  }\r\n  // 观察者模式_data\r\n  observe(vm._data);\r\n}\r\n\r\nexport { initState };\r\n","function compileToRenderFunction(html){\r\n    console.log(html)\r\n\r\n}\r\n\r\nexport {\r\n    compileToRenderFunction\r\n}","import { initState } from './state'\r\nimport { compileToRenderFunction } from './compiler'\r\n\r\nfunction initMixin(Vue) {\r\n  Vue.prototype._init = function (options) {\r\n    var vm = this\r\n    //在vue实例上挂载options用户写的对象\r\n    vm.$options = options\r\n    initState(vm)\r\n\r\n    if (vm.$options.el) {\r\n      // 执行挂载函数\r\n      vm.$mount(vm.$options.el)\r\n    }\r\n  }\r\n\r\n  Vue.prototype.$mount = function (el) {\r\n    const vm = this,\r\n      options = vm.$options\r\n    el = document.querySelector(el)\r\n    vm.$el = el\r\n    // render => template =>el\r\n    if (!options.render) {\r\n      let template = options.template\r\n\r\n      if (!template && el) {\r\n        template = el.outerHTML\r\n      }\r\n\r\n      const render = compileToRenderFunction(template)\r\n      options.render = render\r\n    }\r\n  }\r\n}\r\n\r\nexport { initMixin }\r\n","import {initMixin} from './init'\r\n/*\r\n *数据劫持的目的，是为了在操作数据的过程中，不只是单纯的数据更改操作,\r\n *还要添加上页面渲染等操作\r\n */\r\nfunction Vue(options) {\r\n  this._init(options);\r\n}\r\n\r\ninitMixin(Vue)\r\n\r\nexport default Vue;\r\n"],"names":["proxyData","vm","target","key","Object","defineProperty","get","set","newValue","defineReactiveData","data","value","observe","console","log","observeArr","arr","i","length","ARR_METHODS","originArrMethods","Array","prototype","arrMethods","create","map","m","args","slice","call","arguments","rt","apply","newArr","Observer","isArray","__proto__","walk","keys","initState","options","$options","initData","_data","compileToRenderFunction","html","initMixin","Vue","_init","el","$mount","document","querySelector","$el","render","template","outerHTML"],"mappings":"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"}